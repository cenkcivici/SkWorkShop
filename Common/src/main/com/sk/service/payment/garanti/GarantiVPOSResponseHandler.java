package com.sk.service.payment.garanti;import java.io.ByteArrayInputStream;import java.io.IOException;import javax.xml.parsers.ParserConfigurationException;import javax.xml.parsers.SAXParser;import javax.xml.parsers.SAXParserFactory;import org.apache.http.HttpStatus;import org.springframework.stereotype.Component;import org.xml.sax.SAXException;import com.sk.service.payment.ResponseStatus;import com.sk.service.payment.VPOSResponse;import com.sk.util.http.HttpResult;@Componentpublic class GarantiVPOSResponseHandler {	private SAXParserFactory factory = SAXParserFactory.newInstance();	public VPOSResponse handle(HttpResult result) {		if (result.getHttpStatus() == HttpStatus.SC_OK) {			try {				SAXParser parser = factory.newSAXParser();				GarantiResponseHandler response = new GarantiResponseHandler();				parser.parse(new ByteArrayInputStream(result.getContentAsByteArray()), response);				if (response.hasError()) {					return new VPOSResponse(response.getErrorMsg(), ResponseStatus.FAILURE);				} else {					return new VPOSResponse(ResponseStatus.SUCCESS);				}			} catch (ParserConfigurationException e) {				return notValidResponse();			} catch (SAXException e) {				return notValidResponse();			} catch (IOException e) {				return notValidResponse();			}		} else { // cannot have the response			return new VPOSResponse(ResponseStatus.CONNECTION_PROBLEM);		}	}	private VPOSResponse notValidResponse() {		return new VPOSResponse(ResponseStatus.NOT_VALID_RESPONSE);	}	public void setFactory(SAXParserFactory factory) {		this.factory = factory;	}}